package com.erikschouten.dubins.cc

import kotlin.math.absoluteValue
import kotlin.test.Test
import kotlin.test.assertTrue

class FresnelIntegralsTests {

    @Test
    fun fresnelTests() {
        val validationList = listOf(
            -5 to (-0.4991913819 to -0.5636311887),
            -4 to (-0.4205157543 to -0.498426033),
            -3 to (-0.496312999 to -0.6057207893),
            -2 to (-0.3434156784 to -0.4882534061),
            -1 to (-0.4382591474 to -0.7798934004),
            0 to (0.0 to 0.0),
            1 to (0.4382591474 to 0.7798934004),
            2 to (0.3434156784 to 0.4882534061),
            3 to (0.496312999 to 0.6057207893),
            4 to (0.4205157543 to 0.498426033),
            5 to (0.4991913819 to 0.5636311887),
            6 to (0.4469607612 to 0.4995314679),
            7 to (0.4997047895 to 0.5454670925),
            8 to (0.4602142144 to 0.4998021804),
            9 to (0.4998610456 to 0.5353661274),
            10 to (0.4681699786 to 0.4998986942),
            11 to (0.4999238838 to 0.5289366617),
            12 to (0.4734745649 to 0.4999413694),
            13 to (0.4999538845 to 0.5244851153),
            14 to (0.4772637595 to 0.4999630768),
            15 to (0.4999699798 to 0.5212205317),
//            16 to (0.4801057244 to 0.499975264),
//            17 to (0.4999793773 to 0.5187240428),
//            18 to (0.4823161686 to 0.4999826269),
//            19 to (0.4999852282 to 0.5167531128),
//            20 to (0.4840845359 to 0.499987335),
//            21 to (0.4999890595 to 0.5151575899),
//            22 to (0.4855313876 to 0.4999904846),
//            23 to (0.4999916725 to 0.5138395452),
//            24 to (0.4867371002 to 0.4999926707),
//            25 to (0.4999935155 to 0.5127323855),
//            26 to (0.4877573202 to 0.4999942353),
//            27 to (0.4999948524 to 0.5117892483),
//            28 to (0.4886317954 to 0.4999953844),
//            29 to (0.4999958456 to 0.5109761982),
//            30 to (0.4893896744 to 0.4999962474),
//            31 to (0.4999965989 to 0.5102680574),
//            32 to (0.4900528189 to 0.4999969079),
//            33 to (0.4999971806 to 0.5096457516),
//            34 to (0.4906379467 to 0.4999974221),
//            35 to (0.4999976368 to 0.5090945663),
//            36 to (0.4911580603 to 0.4999978283),
//            37 to (0.4999979997 to 0.5086029685),
//            38 to (0.4916234253 to 0.4999981535),
//            39 to (0.4999982919 to 0.5081617909),
//            40 to (0.4920422538 to 0.4999984169),
//            41 to (0.4999985299 to 0.5077636549),
//            42 to (0.4924211939 to 0.4999986324),
//            43 to (0.4999987256 to 0.5074025548),
//            44 to (0.492765685 to 0.4999988106),
//            45 to (0.4999988881 to 0.5070735525),
        )

        validationList.forEach {
            assertTrue((it.second.first - FresnelIntegrals.S(it.first.toDouble())).absoluteValue < 0.01, "${it.first} | Expected: ${it.second.first}, got: S ${FresnelIntegrals.S(it.first.toDouble())}")
            assertTrue((it.second.second - FresnelIntegrals.C(it.first.toDouble())).absoluteValue < 0.01, "${it.first} | Expected: ${it.second.second}, got: C ${FresnelIntegrals.C(it.first.toDouble())}")
        }
    }
}
